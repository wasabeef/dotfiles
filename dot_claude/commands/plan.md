## Plan

実装前の計画立案モードを起動して、詳細な実装戦略を策定します。コード実装前に構造化された計画を立てることで、効率的な開発を支援します。

### 使い方

```bash
# Claude に Plan Mode を依頼
「[実装内容] の実装計画を立てて」
```

### 基本例

```bash
# 新機能の実装計画
「ユーザー認証機能の実装計画を立てて」

# システム設計の計画
「マイクロサービス分割の実装計画を立てて」

# リファクタリング計画
「レガシーコードのリファクタリング計画を立てて」
```

### Claude との連携

```bash
# 複雑な機能実装
「チャット機能の実装計画を立てて。WebSocket、リアルタイム通知、履歴管理を含めて」

# データベース設計
「EC サイトのデータベース設計計画を立てて。商品、注文、ユーザー管理を含めて」

# API 設計
「GraphQL API の実装計画を立てて。認証、キャッシュ、レート制限を含めて」

# インフラ設計
「Docker 化の実装計画を立てて。開発環境、本番環境、CI/CD を含めて」
```

### Plan Mode の特徴

**自動起動**

- 実装タスクを検出すると自動的に Plan Mode が起動
- 「実装計画を立てて」などのキーワードで明示的に起動可能

**構造化された仕様書**

- 要件定義（ユーザーストーリー・受け入れ基準）
- 設計書（アーキテクチャ・データ設計・ UI 設計）
- 実装計画（タスク分解・進捗追跡・品質保証）
- リスク分析と対策

**承認プロセス**

- `exit_plan_mode` ツールで計画を提示
- **重要**: ツールの戻り値に関わらず、必ずユーザーの明示的承認を待つ
- 承認なしでの実装開始は禁止
- 計画の修正・調整が可能
- 承認後にのみ TodoWrite でタスク管理を開始

### 詳細例

```bash
# 複雑なシステム実装
「オンライン決済システムの実装計画を立てて。Stripe 連携、セキュリティ、エラーハンドリングを含めて」

# フロントエンド実装
「React ダッシュボードの実装計画を立てて。状態管理、コンポーネント設計、テストを含めて」

# バックエンド実装
「RESTful API の実装計画を立てて。認証、バリデーション、ログ記録を含めて」

# DevOps 実装
「CI/CD パイプラインの実装計画を立てて。テスト自動化、デプロイメント、監視を含めて」
```

### 3 段階ワークフロー

#### Phase 1: Requirements（要件定義）

- **ユーザーストーリー**: 機能の目的と価値を明確化
- **受け入れ基準**: 完了条件と品質基準を定義
- **制約・前提条件**: 技術的・時間的制約を整理
- **優先順位付け**: Must-have/Nice-to-have の分類

#### Phase 2: Design（設計）

- **アーキテクチャ設計**: システム構成と技術選定
- **データ設計**: スキーマ、API 仕様、データフロー
- **UI/UX 設計**: 画面構成と操作フロー
- **リスク分析**: 潜在的問題と対策

#### Phase 3: Implementation（実装）

- **タスク分解**: 実装可能な単位への細分化
- **進捗追跡**: TodoWrite による状態管理
- **品質保証**: テスト戦略と検証方法
- **承認プロセス**: exit_plan_mode での計画提示と明示的承認待機

### 注意事項

**適用範囲**

- Plan Mode は複雑な実装タスクに最適
- 単純な修正や小規模な変更の場合は、通常の実装形式を使用
- 3 ステップ以上の作業や新規機能開発に推奨

**技術的制約**

- `exit_plan_mode` ツールの戻り値は信頼しない
- 承認プロセスはユーザーの明示的な意思表示で判断
- CLI の plan mode とは異なる機能

**実行上の注意**

- 承認前の実装開始は厳禁
- 計画提示後は必ずユーザー応答を待機
- エラー時は代替手段を提示

### 実行例

```bash
# 使用例
「ユーザー管理システムの実装計画を立てて」

# 期待される動作
# 1. Plan Mode が自動起動
# 2. 要件分析と技術選定
# 3. 実装ステップの構造化
# 4. exit_plan_mode で計画提示
# 5. 承認後に実装開始
```
