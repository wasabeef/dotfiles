## Role Debate

異なる専門性を持つロールが議論し、トレードオフを検討して最適解を導出するコマンド。

### 使い方

```bash
/role-debate <ロール 1>,<ロール 2> [議題]
/role-debate <ロール 1>,<ロール 2>,<ロール 3> [議題]
```

### 基本例

```bash
# セキュリティ vs パフォーマンスのトレードオフ
/role-debate security,performance
「JWT トークンの有効期限設定について」

# ユーザビリティ vs セキュリティのバランス
/role-debate frontend,security
「2 段階認証の UX 最適化について」

# 技術選定の議論
/role-debate architect,mobile
「React Native vs Flutter の選択について」

# 3 者議論
/role-debate architect,security,performance
「マイクロサービス化の是非について」
```

### 議論プロセス

### Phase 1: 初期立場表明

各ロールが専門視点から独立して意見表明

- 推奨案の提示
- 根拠となる標準・文書の明示
- 想定されるリスク・課題の説明
- 成功指標の定義

### Phase 2: 相互議論・反駁

ロール間でのクロス議論

- 他ロール提案への建設的反論
- 見落とされた視点の指摘
- トレードオフの明確化
- 代替案の提示

### Phase 3: 妥協点探索

実装可能な解決策の模索

- 各視点の重要度評価
- Win-Win 解決策の検討
- 段階的実装アプローチ
- リスク軽減策の検討

### Phase 4: 統合結論

最終的な推奨事項の決定

- 合意された解決策
- 実装ロードマップ
- 成功指標・測定方法
- 将来の見直しポイント

### 出力フォーマット例

### 2 ロール議論の場合

```
🗣️ ロール議論: Security vs Performance
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 議題: JWT トークンの有効期限設定

🔒 Security ロールの主張:
「15 分の短期有効期限を推奨します」

根拠:
- OWASP JWT Security Cheat Sheet 準拠
- トークン漏洩時の被害時間窓を最小化
- 攻撃者の利用可能時間を制限

懸念事項:
- 長期有効期限は攻撃リスクが指数関数的に増大
- コンプライアンス要件（金融系）では短期が必須

成功指標:
- セキュリティインシデント発生率 < 0.1%
- 平均攻撃検出時間 < 5 分

⚡ Performance ロールの反論:
「2 時間の有効期限を推奨します」

根拠:
- Google OAuth 2.0 Best Practices 参考
- 頻繁な再認証によるサーバー負荷増大を回避
- ユーザー体験（作業中断）の最小化

懸念事項:
- 15 分間隔の再認証は API 負荷 8 倍増
- モバイル環境での接続断が頻発

成功指標:
- API レスポンス時間 < 200ms 維持
- サーバー CPU 使用率 < 60%

🔄 相互議論:
Security → Performance:
「サーバー負荷よりもセキュリティ侵害のビジネス損失の方が甚大。
例: Equifax 事件では 7 億ドルの損失」

Performance → Security:
「リフレッシュトークン機構で両立可能。
バックグラウンド更新により UX を損なわずセキュリティ確保」

Security → Performance:
「リフレッシュトークンも攻撃対象。適切な実装が前提」

Performance → Security:
「段階的アプローチを提案。通常操作 30 分、機密操作 15 分」

🤝 妥協点探索:
共通理解:
- ユーザー体験とセキュリティの両立が必要
- リスクレベルに応じた柔軟な対応
- 実装・運用コストの現実的考慮

Win-Win 要素:
- リフレッシュトークン機構の活用
- リスクベース認証の段階的導入
- 自動ログアウト機能による補完

📊 統合結論:
「30 分有効期限 + リフレッシュトークン + リスクベース認証」

実装詳細:
1. アクセストークン: 30 分有効期限
2. リフレッシュトークン: 7 日有効期限
3. 高リスク操作: 15 分で強制再認証
4. 無操作 30 分で自動ログアウト

段階的実装:
週 1-2: 基本的な 30 分トークン実装
週 3-4: リフレッシュトークン機構追加
月 2: リスクベース認証の導入

成功指標:
- セキュリティ: インシデント発生率 < 0.1%
- パフォーマンス: API 負荷増加率 < 20%
- UX: ユーザー満足度 > 85%

将来の見直し:
- 3 ヶ月後: 実際の攻撃パターン・負荷状況を評価
- 6 ヶ月後: より洗練されたリスクベース認証への移行検討
```

### 3 ロール議論の場合

```
🗣️ ロール議論: Architect vs Security vs Performance
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 議題: マイクロサービス化の是非

🏗️ Architect ロールの主張:
「段階的マイクロサービス化を推奨」
根拠: ドメイン境界の明確化、独立したデプロイ、技術選択の自由度

🔒 Security ロールの懸念:
「サービス間通信のセキュリティ複雑化」
根拠: API Gateway、mTLS、分散認証の管理コスト

⚡ Performance ロールの懸念:
「ネットワーク通信によるレイテンシ増加」
根拠: 内部 API 呼び出しによる N+1 問題、分散トランザクション

🔄 3 者議論:
Architect → Security: 「API Gateway で集中管理により統制可能」
Security → Architect: 「単一障害点となるリスク」
Performance → Architect: 「サービス分割の粒度が重要」
...（議論継続）

📊 統合結論:
「ドメイン駆動設計による段階的分割 + セキュリティファースト設計」
```

### 効果的な議論パターン

### 技術選定

```bash
/role-debate architect,performance
「データベース選択: PostgreSQL vs MongoDB」

/role-debate frontend,mobile
「UI フレームワーク: React vs Vue」

/role-debate security,architect
「認証方式: JWT vs Session Cookie」
```

### 設計判断

```bash
/role-debate security,frontend
「ユーザー認証の UX 設計」

/role-debate performance,mobile
「データ同期戦略の最適化」

/role-debate architect,qa
「テスト戦略とアーキテクチャ設計」
```

### トレードオフ問題

```bash
/role-debate security,performance
「暗号化レベル vs 処理速度」

/role-debate frontend,performance
「リッチ UI vs ページ読み込み速度」

/role-debate mobile,security
「利便性 vs データ保護レベル」
```

### 議論品質向上のガイドライン

### 建設的議論のルール

1. **相手の専門性を尊重** - 感情的な反論は避ける
2. **事実・データベース** - 主観ではなく客観的根拠を提示
3. **代替案の提示** - 批判だけでなく改善案も提案
4. **Win-Win の模索** - ゼロサムではなく相互利益を追求

### 効果的な議論進行

1. **明確な論点設定** - 議論すべきポイントを具体化
2. **根拠の明示** - 推奨理由を公式文書・標準で裏付け
3. **リスク評価** - 各選択肢のリスクを定量化
4. **実装可能性** - 理想論ではなく現実的な解決策

### Claude との連携

```bash
# 設計文書を元にした議論
cat system-design.md
/role-debate architect,security
「この設計のセキュリティ面での課題を議論して」

# 問題を元にした解決策議論
cat performance-issues.md
/role-debate performance,architect
「パフォーマンス問題の根本的解決策を議論して」

# 要件を元にした技術選定議論
/role-debate mobile,frontend
「iOS ・ Android ・ Web の統一 UI 戦略について議論して」
```

### 注意事項

- 議論は時間がかかる場合があります（複雑なトピックほど長時間）
- 3 つ以上のロールでは議論が発散する可能性があります
- 最終判断は議論結果を参考にユーザーが行ってください
- 緊急性の高い問題では single role や multi-role を先に検討してください
