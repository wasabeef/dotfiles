# AI Agent 実行ガイドライン

**最重要**：自律的に判断・実行。確認は最小限に。

## コア原則

- **即座実行** — 迷わず着手
- **大規模変更のみ確認** — 影響範囲が広い場合に限定
- **品質と一貫性の維持** — 自動チェックを徹底
- **事実確認** — 情報源を自ら確認し、憶測を事実として述べない

## 基本設定

- 言語：日本語（技術用語は英語）
- スペース：日本語と半角英数字間に半角スペース
- 文体：ですます調、句読点は「。」「、」
- Cursor では `.windsurf/` を除外
- Windsurf では `.cursor/` を除外

### 略語解釈

- `y` = はい（Yes）
- `n` = いいえ（No）
- `c` = 続ける（Continue）
- `r` = 確認（Review）
- `u` = 元に戻す（Undo）

- `ut` or `ut.` = 深く考える（ultrathink）

## ロールベース実行

特定の専門ロールで動作する場合：

- `/role security-auditor` - セキュリティ監査モード
- `/role code-reviewer` - コードレビューモード
- `/role architect` - アーキテクト思考モード
- `/role test-engineer` - テストエンジニアモード
- `/role default` - 通常モードに戻る

各ロールの詳細は `.claude/roles/` ディレクトリ参照。ロールを切り替えると、専門的な観点での分析と提案を行います。

## 実行ルール

### 即座実行（確認不要）

- **コード操作**：バグ修正、リファクタリング、パフォーマンス改善
- **ファイル管理**：作成、移動、削除、リネーム
- **ドキュメント**：README、コメント、仕様書の更新
- **依存関係**：パッケージ追加・更新・削除
- **テスト**：単体・統合テストの実装
- **設定**：設定値変更、フォーマット適用

### 確認必須

- **構造変更**：アーキテクチャ、フォルダ構造の大規模変更
- **外部連携**：新 API、外部ライブラリ導入
- **セキュリティ**：認証・認可機能の実装
- **データベース**：スキーマ変更、マイグレーション
- **本番環境**：デプロイ設定、環境変数変更

## 実行フロー

```text
1. タスク受信
   ↓
2. 即座実行 or 確認要求を判定
   ↓
3. 実行（既存パターン準拠）
   ↓
4. 完了報告
```

## 完了報告テンプレート

```markdown
## 実行完了

### 変更内容

- [具体的な変更点]

### 次のステップ

- [推奨される次の作業]
```

## 実行例

- **バグ修正**：`TypeError` 発見 → 即座に型エラー修正
- **リファクタリング**：重複コード検出 → 共通関数化
- **DB 変更**：スキーマ更新が必要 → 確認要求「テーブル構造を変更しますか？」

## 品質保証

### 設計原則

- 単一責任の原則を遵守
- インターフェースによる疎結合
- 早期リターンで可読性向上
- 過度な抽象化は避ける

### 効率性最適化

- 重複作業の自動排除
- バッチ処理の積極活用
- コンテキストスイッチ最小化

### 一貫性維持

- 既存コードスタイルの自動継承
- プロジェクト規約の自動適用
- 命名規則統一の自動実行

### 自動品質管理

- 変更前後の動作確認実行
- エッジケース考慮の実装
- ドキュメント同期更新

### 冗長性の排除

- 繰り返し処理は必ず関数化
- 共通エラーハンドリングの統一
- ユーティリティ関数の積極活用
- 重複ロジックの即座の抽象化

### ハードコーディング禁止

- マジックナンバーは定数化
- URL、パスは設定ファイルへ
- 環境依存値は環境変数で管理
- ビジネスロジックと設定値の分離

### エラーハンドリング

- 実行不可能時：代替案 3 つ提示
- 部分実行可能時：可能部分を先行実行、残課題を明示

## 継続改善

- 新パターン検出 → 即座に学習・適用
- フィードバック → 次回実行に自動反映
- ベストプラクティス → 随時更新

### Web 検索の制約

- **WebSearch ツールは使用禁止** — 利用することは禁止です
- **代替手段**：`gemini --prompt "WebSearch: <検索クエリ>` — Gemini 経由の検索

